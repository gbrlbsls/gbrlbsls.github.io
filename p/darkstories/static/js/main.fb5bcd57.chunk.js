(this["webpackJsonpdark-stories-front"]=this["webpackJsonpdark-stories-front"]||[]).push([[0],{29:function(t,e,n){},37:function(t,e,n){"use strict";n.r(e);var o=n(0),r=n(20),s=n.n(r),c=n(12),a=n(2),i=n(8),l=n(15);function u(t){var e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",document.body.appendChild(e),e.focus(),e.select();try{var n=document.execCommand("copy")?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+n)}catch(o){console.error("Fallback: Oops, unable to copy",o)}document.body.removeChild(e)}function d(){return window.location.href.substring(0,window.location.href.lastIndexOf("/")+1)}n(29);var h=n(1);function j(t){var e,n,o=t.loading?"skeleton-title":"",r=t.loading?"skeleton-content":"",s=[];if(t.loading)for(var c=0;c<(e=1,n=6,Math.random()*(n-e)+e);c++)s.push(Object(h.jsx)("span",{},c));function a(e){return t.loading?"":e}return Object(h.jsx)("div",{className:"row justify-content-center pt-3\tfont-monospace",style:{minHeight:"60vh"},children:Object(h.jsxs)("div",{className:"col-12",children:[Object(h.jsx)("div",{className:"row",children:Object(h.jsx)("div",{className:"col-md-12",children:Object(h.jsx)("span",{className:"text-start h4 "+o,children:a(t.title)})})}),Object(h.jsx)("hr",{}),Object(h.jsx)("div",{className:"row",children:Object(h.jsx)("div",{className:"col-md-8",children:Object(h.jsxs)("p",{className:"text-start lead fs-6 "+r,children:[t.loading&&s,a(t.content)]})})})]})})}var b=n(7),p=n.n(b),f=n(10),y=n(13),O=n(14),m=n(24),g=n(23),v=function(){function t(){Object(y.a)(this,t)}return Object(O.a)(t,null,[{key:"post",value:function(){var t=Object(f.a)(p.a.mark((function t(e){var n,o,r,s=arguments;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:null,o=s.length>2&&void 0!==s[2]?s[2]:{},r={body:JSON.stringify(n)},t.next=5,fetch("".concat(this.baseUrl).concat(e),Object(i.a)(Object(i.a)(Object(i.a)({},r),this._postRequestOptions),o));case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"get",value:function(){var t=Object(f.a)(p.a.mark((function t(e){var n,o=arguments;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},t.next=3,fetch("".concat(this.baseUrl).concat(e),Object(i.a)(Object(i.a)({},this._getRequestOptions),n));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}();v.baseUrl="",v._postRequestOptions={method:"POST",headers:{"Content-Type":"application/json"}},v._getRequestOptions={method:"GET",mode:"cors",redirect:"follow",headers:{"Content-Type":"application/json"}};var x=function(t){Object(m.a)(n,t);var e=Object(g.a)(n);function n(){return Object(y.a)(this,n),e.apply(this,arguments)}return Object(O.a)(n,null,[{key:"newGame",value:function(){var t=Object(f.a)(p.a.mark((function t(){var e,n,o=arguments;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=o.length>0&&void 0!==o[0]?o[0]:null,n="",n=null!=e?"/game/new-game-from-story-hash":"/game/new-game",t.next=5,this.post(n,e);case 5:return t.abrupt("return",t.sent.json());case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getStoryById",value:function(){var t=Object(f.a)(p.a.mark((function t(e){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.get("/story/get-story-by-id?id=".concat(e));case 2:return t.next=4,t.sent.json();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),n}(v);function w(){Object(a.f)();var t=Object(o.useState)({story:{id:0,title:"",content:"",resolution:"",hash:0},loading:!0}),e=Object(l.a)(t,2),n=e[0],r=e[1],s=Object(a.g)().storyHash;function c(){r(Object(i.a)(Object(i.a)({},n),{},{loading:!0})),x.newGame().then((function(t){r({story:t.story,loading:!1}),window.story=t.story})).catch((function(t){console.log({err:t}),r({loading:!1,story:{id:0,title:"Algo deu errado...",content:"N\xe3o foi poss\xedvel obter uma hist\xf3ria...",resolution:"Voc\xea se deu mal",hash:0}})}))}function b(t){window.open("#story","_blank","height=480,width=480").story=window.story}function p(){u("".concat(d(),"story/").concat(window.story.id)),alert("Link para hist\xf3ria copiado!")}function f(){u("".concat(d()).concat(window.story.hash)),alert("Link para jogo da hist\xf3ria copiado!")}return Object(o.useEffect)((function(){return null==s?c():function(){window.history.replaceState({},document.title,"/"),x.newGame(s).then((function(t){r({story:t.story,loading:!1}),window.story=t.story})).catch((function(t){console.log({err:t}),r({loading:!1,story:{id:0,title:"Algo deu errado...",content:"N\xe3o foi poss\xedvel obter uma hist\xf3ria...",resolution:"Voc\xea se deu mal",hash:0}})}))}()}),[]),Object(h.jsxs)("div",{children:[Object(h.jsx)(j,{title:n.story.title,content:n.story.content,loading:n.loading}),Object(h.jsx)("hr",{}),Object(h.jsx)("div",{className:"row",children:Object(h.jsxs)("div",{className:"btn-group-vertical",children:[Object(h.jsx)("div",{className:"btn btn-outline-light",onClick:b,children:"Abrir resolu\xe7\xe3o"}),Object(h.jsx)("div",{className:"btn btn-outline-light",onClick:c,children:"Novo jogo"}),Object(h.jsx)("div",{className:"btn btn-outline-light",onClick:p,children:"Compartilhar"}),Object(h.jsx)("div",{className:"btn btn-outline-light",onClick:f,children:"Copiar jogo"})]})})]})}function k(t){var e=Object(a.g)().storyId,n=Object(o.useState)({story:{title:"-",content:"-",resolution:""},loading:!0}),r=Object(l.a)(n,2),s=r[0],c=r[1];return console.log("gameStory.mount"),Object(o.useEffect)((function(){if(null==e)return;x.getStoryById(parseInt(e)).then((function(t){c({story:t,loading:!1})})).catch((function(t){console.log({err:t}),c({story:{title:"Falha ao carregar...",content:"-",resolution:""},loading:!1})}))}),[]),Object(o.useEffect)((function(){if(null==window.story)return;c({story:window.story,loading:!1})}),[]),Object(h.jsxs)("div",{children:[Object(h.jsx)(j,{title:s.story.title,content:s.story.content,loading:s.loading}),Object(h.jsx)("hr",{}),Object(h.jsx)("div",{className:"row",children:Object(h.jsx)("div",{className:"col-md-8",children:Object(h.jsx)("p",{className:"text-start lead fs-6",children:s.story.resolution})})})]})}x.baseUrl="https://hidden-wildwood-83104.herokuapp.com",x._getRequestOptions={method:"GET",mode:"cors"},console.log("App.tsx loaded");var N=function(){return Object(h.jsx)("div",{className:"container",children:Object(h.jsx)(c.a,{children:Object(h.jsxs)(a.c,{children:[Object(h.jsx)(a.a,{path:"/story/:storyId",component:k}),Object(h.jsx)(a.a,{path:"/story",component:k}),Object(h.jsx)(a.a,{path:"/:storyHash",component:w}),Object(h.jsx)(a.a,{path:"/",component:w})]})})})};console.log("index.tsx loaded"),s.a.render(Object(h.jsx)(N,{}),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.fb5bcd57.chunk.js.map