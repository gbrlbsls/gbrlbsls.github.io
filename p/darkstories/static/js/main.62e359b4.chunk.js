(this["webpackJsonpdark-stories-front"]=this["webpackJsonpdark-stories-front"]||[]).push([[0],{29:function(t,e,n){},37:function(t,e,n){"use strict";n.r(e);var o=n(20),s=n.n(o),c=n(0),a=n(12),r=n(2),i=n(4),l=n(15);function d(t){return console.log(window.location),"".concat(window.location.host).concat(window.location.pathname,"#").concat(t)}function u(t){var e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",document.body.appendChild(e),e.focus(),e.select();try{var n=document.execCommand("copy")?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+n)}catch(o){console.error("Fallback: Oops, unable to copy",o)}document.body.removeChild(e)}n(29);var h=n(1);function j(t){var e,n,o=t.loading?"skeleton-title":"",s=t.loading?"skeleton-content":"",c=[];if(t.loading)for(var a=0;a<(e=1,n=6,Math.random()*(n-e)+e);a++)c.push(Object(h.jsx)("span",{},a));function r(e){return t.loading?"":e}return Object(h.jsx)("div",{className:"row justify-content-center pt-3\tfont-monospace",style:{minHeight:"60vh"},children:Object(h.jsxs)("div",{className:"col-12",children:[Object(h.jsx)("div",{className:"row",children:Object(h.jsx)("div",{className:"col-md-12",children:Object(h.jsx)("span",{className:"text-start h4 "+o,children:r(t.title)})})}),Object(h.jsx)("hr",{}),Object(h.jsx)("div",{className:"row",children:Object(h.jsx)("div",{className:"col-md-8",children:Object(h.jsxs)("p",{className:"text-start lead fs-6 "+s,children:[t.loading&&c,r(t.content)]})})})]})})}var b=n(8),p=n.n(b),m=n(10),O=n(13),f=n(14),y=n(24),g=n(23),x=function(){function t(){Object(O.a)(this,t)}return Object(f.a)(t,null,[{key:"post",value:function(){var t=Object(m.a)(p.a.mark((function t(e){var n,o,s,c=arguments;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:null,o=c.length>2&&void 0!==c[2]?c[2]:{},s={body:JSON.stringify(n)},t.next=5,fetch("".concat(this.baseUrl).concat(e),Object(i.a)(Object(i.a)(Object(i.a)({},s),this._postRequestOptions),o));case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"get",value:function(){var t=Object(m.a)(p.a.mark((function t(e){var n,o=arguments;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},t.next=3,fetch("".concat(this.baseUrl).concat(e),Object(i.a)(Object(i.a)({},this._getRequestOptions),n));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}();x.baseUrl="",x._postRequestOptions={method:"POST",headers:{"Content-Type":"application/json"}},x._getRequestOptions={method:"GET",mode:"cors",redirect:"follow",headers:{"Content-Type":"application/json"}};var v=function(t){Object(y.a)(n,t);var e=Object(g.a)(n);function n(){return Object(O.a)(this,n),e.apply(this,arguments)}return Object(f.a)(n,null,[{key:"newGame",value:function(){var t=Object(m.a)(p.a.mark((function t(){var e,n,o=arguments;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=o.length>0&&void 0!==o[0]?o[0]:null,n="",n=null!=e?"/game/new-game-from-story-hash":"/game/new-game",t.next=5,this.post(n,e);case 5:return t.abrupt("return",t.sent.json());case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getStoryById",value:function(){var t=Object(m.a)(p.a.mark((function t(e){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.get("/story/get-story-by-id?id=".concat(e));case 2:return t.next=4,t.sent.json();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),n}(x);v.baseUrl="https://hidden-wildwood-83104.herokuapp.com",v._getRequestOptions={method:"GET",mode:"cors"};var w=v;function N(){var t=Object(c.useState)({story:{id:0,title:"",content:"",resolution:"",hash:0},loading:!0,hiddenResolution:!0}),e=Object(l.a)(t,2),n=e[0],o=e[1],s=Object(r.f)().storyHash;function a(){o(Object(i.a)(Object(i.a)({},n),{},{loading:!0,hiddenResolution:!0})),w.newGame().then((function(t){o(Object(i.a)(Object(i.a)({},n),{},{story:t.story,loading:!1})),window.story=t.story})).catch((function(t){console.log({err:t}),o(Object(i.a)(Object(i.a)({},n),{},{loading:!1,story:{id:0,title:"Algo deu errado...",content:"N\xe3o foi poss\xedvel obter uma hist\xf3ria...",resolution:"Voc\xea se deu mal",hash:0}}))}))}function b(t){o(Object(i.a)(Object(i.a)({},n),{},{hiddenResolution:!n.hiddenResolution}))}function p(t){window.open("#story","_blank","height=480,width=480").story=window.story}function m(){u(d("story/".concat(window.story.id))),alert("Link para hist\xf3ria copiado!")}function O(){u(d("hash/".concat(window.story.hash))),alert("Link para jogo da hist\xf3ria copiado!")}return Object(c.useEffect)((function(){null==s?a():(window.history.replaceState({},document.title,window.location.href.replace(window.location.hash,"#")),w.newGame(s).then((function(t){o(Object(i.a)(Object(i.a)({},n),{},{story:t.story,loading:!1})),window.story=t.story})).catch((function(t){console.log({err:t}),o(Object(i.a)(Object(i.a)({},n),{},{loading:!1,story:{id:0,title:"Algo deu errado...",content:"N\xe3o foi poss\xedvel obter uma hist\xf3ria...",resolution:"Voc\xea se deu mal",hash:0}}))})))}),[]),Object(h.jsx)("div",{children:Object(h.jsxs)("div",{className:"row row-cols-2",children:[Object(h.jsxs)("div",{className:"col-12 col-md-8",children:[Object(h.jsx)(j,{title:n.story.title,content:n.story.content,loading:n.loading}),!n.hiddenResolution&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("hr",{}),Object(h.jsx)("p",{className:"text-start lead fs-6",children:n.story.resolution})]})]}),Object(h.jsx)("div",{className:"col-12 col-md-4",children:Object(h.jsxs)("div",{className:"btn-group-vertical w-100 mt-3 pt-5",children:[Object(h.jsx)("button",{className:"btn btn-outline-light text-md-start",onClick:b,disabled:n.loading,children:"Mostrar resolu\xe7\xe3o"}),Object(h.jsx)("button",{className:"btn btn-outline-light text-md-start",onClick:p,disabled:n.loading,children:"Abrir resolu\xe7\xe3o"}),Object(h.jsx)("div",{className:"mb-1"}),Object(h.jsx)("button",{className:"btn btn-outline-light text-md-start",onClick:a,disabled:n.loading,children:"Novo jogo"}),Object(h.jsx)("button",{className:"btn btn-outline-light text-md-start",onClick:m,disabled:n.loading,children:"Compartilhar"}),Object(h.jsx)("div",{className:"mb-1"}),Object(h.jsx)("button",{className:"btn btn-outline-light text-md-start",onClick:O,disabled:n.loading,children:"Copiar jogo"})]})})]})})}function k(){var t=Object(r.f)().storyId,e=Object(c.useState)({story:{title:"-",content:"-",resolution:""},loading:!0}),n=Object(l.a)(e,2),o=n[0],s=n[1];return console.log("gameStory.mount"),Object(c.useEffect)((function(){null!=t&&w.getStoryById(parseInt(t)).then((function(t){s({story:t,loading:!1})})).catch((function(t){console.log({err:t}),s({story:{title:"Falha ao carregar...",content:"-",resolution:""},loading:!1})}))}),[t]),Object(c.useEffect)((function(){if(null==window.story)return;s({story:window.story,loading:!1})}),[]),Object(h.jsxs)("div",{children:[Object(h.jsx)(j,{title:o.story.title,content:o.story.content,loading:o.loading}),Object(h.jsx)("hr",{}),Object(h.jsx)("div",{className:"row",children:Object(h.jsx)("div",{className:"col-md-8",children:Object(h.jsx)("p",{className:"text-start lead fs-6",children:o.story.resolution})})})]})}console.log("App.tsx loaded");var C=function(){return Object(h.jsx)("div",{className:"container",children:Object(h.jsx)(a.a,{children:Object(h.jsxs)(r.c,{children:[Object(h.jsx)(r.a,{path:"/story/:storyId",component:k}),Object(h.jsx)(r.a,{path:"/story",component:k}),Object(h.jsx)(r.a,{path:"/hash/:storyHash",component:N}),Object(h.jsx)(r.a,{path:"/",component:N})]})})})};console.log("index.tsx loaded"),s.a.render(Object(h.jsx)(C,{}),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.62e359b4.chunk.js.map